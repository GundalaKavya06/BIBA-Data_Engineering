CREATE TABLE  employees2(
EMPLOYEE_ID INT,
F_NAME Varchar(50),
L_NAME Varchar(50),
EMAIL  VARCHAR(60),
PHONE_NUMBER VARCHAR(60),
HIRE_DATE VARCHAR(60),
JOB_ID  VARCHAR(50),
SALARY  DECIMAL,
COMMISSION  DECIMAL,
MNGR_ID  INT,
DEPT_ID INT,
Primary Key(EMPLOYEE_ID)
);
 INSERT INTO employees2(EMPLOYEE_ID,F_NAME,L_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION,MNGR_ID,DEPT_ID) VALUES 
 ('100','Steven','King','SKING','515.123.4567','1987-06-17','AD_PRES','24000.00','0.00','0','90'), 
 ('101','Neena','Kochhar','NKOCHHAR','515.123.4568','1987-06-18','AD_VP','17000.00', '0.00' ,'100' ,'90'),
 ('102' ,'Lex','De Haan' ,'LDEHAAN','515.123.4569','1987-06-19','AD_VP','17000.00', '0.00','100','90'), 
 ('103' ,'Alexander','Hunold', 'AHUNOL', '590.423.4567' ,'1987-06-20','IT_PROG','9000.00', '0.00' ,'102' ,'60'),
 ('104' , 'Bruce','Ernst', 'BERNST' ,' 590.423.4568', '1987-06-21' , 'IT_PROG','6000.00','0.00', '103', '60'),
 ('105' , 'David','Austin', 'DAUSTIN' ,'590.423.4569', '1987-06-22', 'IT_PROG' , '4800.00','0.00', '103', '60'),
 ('106' , 'Valli','Pataballa' ,'VPATABAL', '590.423.4560' , '1987-06-23' , 'IT_PROG' , '4800.00','0.00', '103', '60'),
 ('107' , 'Diana','Lorentz' , 'DLORENTZ','590.423.5567' , '1987-06-24' , 'IT_PROG' , '4200.00', '0.00' ,'103', '60'),
 ('108' , 'Nancy','Greenberg' , 'NGREENBE' , '515.124.4569', '1987-06-25' , 'FI_MGR','12000.00' ,'0.00', '101','100' ),
 ('109' , 'Daniel', 'Faviet', 'DFAVIET','515.124.4169', '1987-06-26','FI_ACCOUNT', '9000.00', '0.00' ,'108','100'),
 ('110' , 'John', 'Chen' ,'JCHEN','515.124.4269', '1987-06-27' , 'FI_ACCOUNT', '8200.00' ,'0.00', '108' , '100' );
 INSERT INTO employees2(EMPLOYEE_ID,F_NAME,L_NAME,EMAIL,PHONE_NUMBER,HIRE_DATE,JOB_ID,SALARY,COMMISSION,MNGR_ID,DEPT_ID) VALUES 
 (111,'Steven','King','SKING','515.123.4567','1987-06-17','AD_PRES','22000.00','0.00','0','90');
 
 select * from employees2;

 CREATE TABLE JOBS1 (JOB_ID VARCHAR(10), SALARY DECIMAL, HIRE_DATE VARCHAR(10),COMMISSION DECIMAL, DEPT_ID INT);

 INSERT INTO JOBS1 VALUES('AD_PRES', 24000.00,'1987-06-17',0.00,90);
 INSERT INTO JOBS1 VALUES('AD_VP', 17000.00,'1987-06-18',0.00,90);
 INSERT INTO JOBS1 VALUES('IT_PROG', 9000.00,'1987-06-20',0.00,60);
 INSERT INTO JOBS1 VALUES('FI_MGR', 12000.00,'1987-06-25',0.00,100);
 INSERT INTO JOBS1 VALUES('SA_PROG', 22000.00,'1987-06-23',0.00,80);
 INSERT INTO JOBS1 VALUES('AC_MGR', 10000.00,'1987-07-02',0.00,60);

 CREATE TABLE JOB_HISTORY(JOB_ID VARCHAR(10), DEPARTMENT_ID INT);

 INSERT INTO JOB_HISTORY VALUES ('AD_PRES',90);
 INSERT INTO JOB_HISTORY VALUES ('AD_VP',90);
 INSERT INTO JOB_HISTORY VALUES ('IT_PROG',60);
 INSERT INTO JOB_HISTORY VALUES ('FI_MGR',100);
 INSERT INTO JOB_HISTORY VALUES ('SA_PROG',80);
 
 /*NESTED SUB QUERIES- THE RESULT OF INNER QUERY USED BY OUTER QUERY*/
SELECT EMPLOYEE_ID, F_NAME, L_NAME, EMAIL, HIRE_DATE, SALARY, DEPT_ID
FROM EMPLOYEES2 WHERE SALARY IN(
SELECT salary
FROM jobs1 WHERE job_id 
IN(SELECT job_id FROM job_history  
WHERE department_id      
BETWEEN 50 AND 100
));

/*CORRELATED SUBQUERY - INNER QUERY USES OUTER QUERY VALUES*/
SELECT employee_id, mngr_id, f_name, l_name
FROM employees2 a
WHERE EXISTS
(SELECT employee_id
FROM employees2 b
WHERE b.mngr_id = a.employee_id);



